title: Suspicious PowerShell Encoded Command
id: 7f56c5-ab12-4e89-b1c2-9d3f8e1a0b2c
status: test
description: Detects execution of PowerShell with encoded commands - common malware technique
author: SOC Portfolio
date: 2025/01/01
tags:
    - attack.execution
    - attack.t1059.001  # PowerShell
references:
    - https://attack.mitre.org/techniques/T1059/001/
logsource:
    category: process_creation
    product: windows
detection:
    selection:
        Image|endswith: '\powershell.exe'
        CommandLine|contains:
            - ' -enc '
            - ' -EncodedCommand '
            - ' -ec '
    condition: selection
falsepositives:
    - Some legitimate software uses encoded PowerShell
    - SCCM deployments
level: medium
